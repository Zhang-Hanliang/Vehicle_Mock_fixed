# ğŸš€ Vehicle Mock éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é•œåƒæ ‡ç­¾ç­–ç•¥

æ¯æ¬¡GitHub Actionsæ„å»ºä¼šç”Ÿæˆ**3ä¸ªå”¯ä¸€æ ‡ç­¾**ï¼š

1. **`:latest`** - æ°¸è¿œæŒ‡å‘æœ€æ–°æ„å»º
2. **`:æ•°å­—`** - GitHub Actionsè¿è¡Œç¼–å·ï¼ˆå¦‚`:1`, `:2`, `:3`...ï¼‰**â† æ¨èä½¿ç”¨**
3. **`:sha-xxxxxxx`** - Git commitçš„å®Œæ•´SHAå€¼

---

## ğŸ¯ æ¨èä½¿ç”¨æ–¹å¼ï¼šç¼–å·æ ‡ç­¾

### **åœ¨CCUè®¾å¤‡ä¸Šæ‹‰å–é•œåƒï¼š**

```bash
# 1. æŸ¥çœ‹GitHub Actionsé¡µé¢ï¼Œè·å–æœ€æ–°çš„è¿è¡Œç¼–å·
# ä¾‹å¦‚ï¼šBuild #15

# 2. åœ¨CCUä¸Šæ‹‰å–å¯¹åº”ç¼–å·çš„é•œåƒ
docker pull ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:15

# 3. åœæ­¢æ—§å®¹å™¨
docker compose down

# 4. ä¿®æ”¹docker-compose.ymlï¼Œä½¿ç”¨æ–°ç¼–å·
# ç¼–è¾‘: image: ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:15

# 5. å¯åŠ¨æ–°å®¹å™¨
docker compose up -d

# 6. æŸ¥çœ‹æ—¥å¿—
docker logs -f debian-vehicle-mock-1
```

---

## ğŸ“ å®Œæ•´æ“ä½œæµç¨‹

### **1ï¸âƒ£ åœ¨Windowså¼€å‘æœºä¸Šæ¨é€ä»£ç **
```bash
cd c:\Users\AHH1SGH\Desktop\Mock_Test
git add .
git commit -m "fix: ä¿®å¤æŸä¸ªé—®é¢˜"
git push
```

### **2ï¸âƒ£ åœ¨GitHubä¸ŠæŸ¥çœ‹æ„å»ºç¼–å·**
è®¿é—®ï¼šhttps://github.com/Zhang-Hanliang/Vehicle_Mock_fixed/actions

æ‰¾åˆ°æœ€æ–°çš„workflowè¿è¡Œï¼Œè®°ä¸‹ç¼–å·ï¼ˆä¾‹å¦‚ `#15`ï¼‰

### **3ï¸âƒ£ åœ¨CCUè®¾å¤‡ä¸Šæ›´æ–°é•œåƒ**
```bash
# SSHç™»å½•åˆ°CCU
ssh debian@A12FA9

# æ‹‰å–æ–°é•œåƒï¼ˆä½¿ç”¨ä¸Šé¢çœ‹åˆ°çš„ç¼–å·ï¼‰
docker pull ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:15

# åœæ­¢æœåŠ¡
cd /path/to/your/docker-compose/
docker compose down

# ç¼–è¾‘docker-compose.yml
nano docker-compose.yml
# ä¿®æ”¹è¿™ä¸€è¡Œï¼š
#   image: ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:15

# å¯åŠ¨æœåŠ¡
docker compose up -d

# å®æ—¶æŸ¥çœ‹æ—¥å¿—ï¼Œç¡®è®¤æ²¡æœ‰é”™è¯¯
docker logs -f debian-vehicle-mock-1
```

---

## ğŸ”§ ç®€åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰

åœ¨CCUä¸Šåˆ›å»ºæ›´æ–°è„šæœ¬ `/home/debian/update-mock.sh`ï¼š

```bash
#!/bin/bash
# update-mock.sh - Vehicle Mock æ›´æ–°è„šæœ¬

if [ -z "$1" ]; then
    echo "âŒ é”™è¯¯ï¼šéœ€è¦æŒ‡å®šé•œåƒç¼–å·"
    echo "ç”¨æ³•: $0 <ç¼–å·>"
    echo "ä¾‹å¦‚: $0 15"
    exit 1
fi

BUILD_NUM=$1
IMAGE="ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:${BUILD_NUM}"

echo "ğŸ”„ æ›´æ–° vehicle-mock åˆ°ç‰ˆæœ¬ #${BUILD_NUM}"
echo ""

# æ‹‰å–é•œåƒ
echo "â¬‡ï¸  æ‹‰å–é•œåƒ..."
docker pull ${IMAGE}
if [ $? -ne 0 ]; then
    echo "âŒ æ‹‰å–å¤±è´¥ï¼"
    exit 1
fi

# åœæ­¢å®¹å™¨
echo "ğŸ“¦ åœæ­¢å®¹å™¨..."
cd /home/debian  # ä¿®æ”¹ä¸ºä½ çš„docker-compose.ymlæ‰€åœ¨ç›®å½•
docker compose down

# æ›´æ–°docker-compose.yml
echo "âœï¸  æ›´æ–°é…ç½®..."
sed -i "s|image: ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:.*|image: ${IMAGE}|g" docker-compose.yml

# å¯åŠ¨å®¹å™¨
echo "ğŸš€ å¯åŠ¨å®¹å™¨..."
docker compose up -d

# ç­‰å¾…å¯åŠ¨
sleep 3

# æ˜¾ç¤ºæ—¥å¿—
echo ""
echo "ğŸ“‹ å®¹å™¨æ—¥å¿—ï¼š"
docker logs --tail 30 debian-vehicle-mock-1

echo ""
echo "âœ… æ›´æ–°å®Œæˆï¼"
echo "ç»§ç»­æŸ¥çœ‹æ—¥å¿—: docker logs -f debian-vehicle-mock-1"
```

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
chmod +x /home/debian/update-mock.sh

# æ›´æ–°åˆ°ç‰ˆæœ¬15
./update-mock.sh 15
```

---

## ğŸ“Š æ ‡ç­¾å¯¹æ¯”è¡¨

| æ ‡ç­¾ç±»å‹ | ç¤ºä¾‹ | å”¯ä¸€æ€§ | æ¨èåœºæ™¯ |
|---------|------|--------|---------|
| **ç¼–å·æ ‡ç­¾** | `:15` | âœ… å”¯ä¸€ | **æ¨èï¼šæ—¥å¸¸æ›´æ–°** |
| SHAæ ‡ç­¾ | `:sha-868dc93abc...` | âœ… å”¯ä¸€ | éœ€è¦ç²¾ç¡®è¿½æº¯commit |
| latest | `:latest` | âŒ ä¼šè¦†ç›– | å¿«é€Ÿæµ‹è¯•ï¼ˆéœ€æ‰‹åŠ¨åˆ é™¤æ—§é•œåƒï¼‰ |

---

## âœ… ä¼˜åŠ¿

ä½¿ç”¨ç¼–å·æ ‡ç­¾çš„å¥½å¤„ï¼š

1. âœ… **ç¼–å·é€’å¢**ï¼šå®¹æ˜“ç†è§£ï¼ŒçŸ¥é“å“ªä¸ªæ˜¯æœ€æ–°çš„
2. âœ… **æ°¸è¿œå”¯ä¸€**ï¼šæ¯æ¬¡æ„å»ºç¼–å·ä¸åŒï¼Œä¸ä¼šæœ‰ç¼“å­˜é—®é¢˜  
3. âœ… **ç®€æ´æ˜“ç”¨**ï¼šæ¯”é•¿é•¿çš„SHAæ›´æ–¹ä¾¿è¾“å…¥
4. âœ… **è‡ªåŠ¨ç”Ÿæˆ**ï¼šGitHub Actionsè‡ªåŠ¨åˆ†é…ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤
5. âœ… **å®Œå…¨å¯è¿½æº¯**ï¼šåœ¨GitHub Actionsé¡µé¢å¯ä»¥çœ‹åˆ°æ¯ä¸ªç¼–å·å¯¹åº”çš„æ„å»ºè¯¦æƒ…

---

## ğŸ› æ•…éšœæ’æŸ¥

### **é—®é¢˜1ï¼šä¸çŸ¥é“æœ€æ–°çš„ç¼–å·æ˜¯å¤šå°‘**
**è§£å†³ï¼š**
```bash
# æ–¹æ³•1ï¼šæŸ¥çœ‹GitHub Actionsé¡µé¢
# https://github.com/Zhang-Hanliang/Vehicle_Mock_fixed/actions

# æ–¹æ³•2ï¼šåœ¨CCUä¸ŠæŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ ‡ç­¾
docker pull ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:latest
docker inspect ghcr.io/zhang-hanliang/vehicle_mock_fixed/vehicle-mock:latest | grep "Created"
```

### **é—®é¢˜2ï¼šæ‹‰å–é•œåƒæƒé™é”™è¯¯**
**è§£å†³ï¼š**
```bash
# ç™»å½•GitHub Container Registry
docker login ghcr.io -u zhang-hanliang
# è¾“å…¥ä½ çš„GitHub Personal Access Token
```

### **é—®é¢˜3ï¼šæƒ³å›æ»šåˆ°æ—§ç‰ˆæœ¬**
**è§£å†³ï¼š**
```bash
# ä½¿ç”¨ä¹‹å‰çš„ç¼–å·å³å¯
./update-mock.sh 12  # å›æ»šåˆ°ç‰ˆæœ¬12
```
